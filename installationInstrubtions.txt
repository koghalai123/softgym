# MUST USE OLD VERSION OF MINICONDA or you will run into a glibc version mismatch. I used one from 2023

#Entering container

conda activate softgym

docker run \
    -v /home/koghalai/softagent/softgym:/workspace/softgym \
    -v /home/koghalai/miniconda3:/home/koghalai/miniconda3 \
    -v /tmp/.X11-unix:/tmp/.X11-unix \
    -e DISPLAY=$DISPLAY \
    -e QT_X11_NO_MITSHM=1 \
    -it xingyu/softgym:latest bash


#Compiling within docker
cd softgym/
export PATH="/home/koghalai/miniconda3/bin:$PATH"
. ./prepare_1.0.sh

# Run in each new terminal window: 

```
export PYFLEXROOT=${PWD}/PyFlex
export PYTHONPATH=${PYFLEXROOT}/bindings/build:$PYTHONPATH
export LD_LIBRARY_PATH=${PYFLEXROOT}/external/SDL2-2.0.4/lib/x64:$LD_LIBRARY_PATH
```

# If softgym module cannot be found

export PYTHONPATH=$(pwd):$PYTHONPATH

# If this error occurs: 

File "/home/koghalai/miniconda3/envs/softgym/lib/python3.6/site-packages/imageio_ffmpeg/_utils.py", line 6, in <module>
    import importlib.resources
ModuleNotFoundError: No module named 'importlib.resources'

# then

pip uninstall imageio-ffmpeg
pip install imageio-ffmpeg==0.3.0


# If there is an issue with: extension `GL_EXT_geometry_shader4' unsupported in geometry shader

sudo prime-select nvidia

# TEST SOFTGYM HERE TO ENSURE IT IS WORKING BEFORE MOVING ON

# you must install 'bazel' version 5.0.0 before moving onto conda dependencies for softagent

wget https://github.com/bazelbuild/bazel/releases/download/5.0.0/bazel-5.0.0-linux-x86_64
chmod +x bazel-5.0.0-linux-x86_64
sudo mv bazel-5.0.0-linux-x86_64 /usr/local/bin/bazel
bazel version

# If FileNotFoundError: The directory '/home/koghalai/softagent/softgym/data' does not exist

Then creata a 'data' folder in the softgym folder

# when updating conda env to be used with soft agent, you might get this error:

ResolvePackageNotFound: 
  - gtimer
  - sk-video
  - imageio-ffmpeg
  - opencv-python=5.1.1
  - moviepy
  - gym=0.14.0
  - pyquaternion=0.9.5

You need to move the bad dependencies to pip. LLMs did a reasonable job of this 
